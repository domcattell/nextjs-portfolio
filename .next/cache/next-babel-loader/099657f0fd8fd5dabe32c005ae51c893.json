{"ast":null,"code":"var jwt = require(\"jsonwebtoken\");\n\nvar secret = \"secret\";\n\nvar checkAuth = function checkAuth(req, res, next) {\n  var token = req.header('x-auth-token');\n\n  if (!token) {\n    res.status(401).json({\n      msg: \"Please login\"\n    });\n  } else {\n    jwt.verify(token, secret, function (err, decoded) {\n      if (err) {\n        res.status(403).json({\n          msg: \"session expired\"\n        });\n      } else {\n        req.username = decoded.username;\n        next();\n      }\n\n      ;\n    });\n  }\n\n  ;\n};\n\nmodule.exports = checkAuth;","map":{"version":3,"sources":["C:/Users/domin/Documents/domcattell/site/server/middleware/checkAuth.js"],"names":["jwt","require","secret","checkAuth","req","res","next","token","header","status","json","msg","verify","err","decoded","username","module","exports"],"mappings":"AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,IAAMC,MAAM,GAAG,QAAf;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClC,MAAMC,KAAK,GAAGH,GAAG,CAACI,MAAJ,CAAW,cAAX,CAAd;;AAEA,MAAG,CAACD,KAAJ,EAAW;AACPF,IAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,GAAG,EAAE;AAAN,KAArB;AACH,GAFD,MAEO;AACHX,IAAAA,GAAG,CAACY,MAAJ,CAAWL,KAAX,EAAkBL,MAAlB,EAA0B,UAACW,GAAD,EAAMC,OAAN,EAAkB;AACxC,UAAGD,GAAH,EAAQ;AACJR,QAAAA,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,UAAAA,GAAG,EAAE;AAAN,SAArB;AACH,OAFD,MAEO;AACHP,QAAAA,GAAG,CAACW,QAAJ,GAAeD,OAAO,CAACC,QAAvB;AACAT,QAAAA,IAAI;AACP;;AAAA;AACJ,KAPD;AAQH;;AAAA;AACJ,CAfD;;AAiBAU,MAAM,CAACC,OAAP,GAAiBd,SAAjB","sourcesContent":["const jwt = require(\"jsonwebtoken\");\r\nconst secret = \"secret\";\r\n\r\nconst checkAuth = (req, res, next) => {\r\n    const token = req.header('x-auth-token');\r\n\r\n    if(!token) {\r\n        res.status(401).json({msg: \"Please login\"});\r\n    } else {\r\n        jwt.verify(token, secret, (err, decoded) => {\r\n            if(err) {\r\n                res.status(403).json({msg: \"session expired\"});\r\n            } else {\r\n                req.username = decoded.username\r\n                next();\r\n            };\r\n        });\r\n    };\r\n};\r\n\r\nmodule.exports = checkAuth;"]},"metadata":{},"sourceType":"script"}