{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { createContext, useReducer } from 'react';\nimport axios from 'axios';\nimport authReducer from '../reducers/auth.reducer';\nimport authToken from '../../helpers/authToken';\nimport { LOGIN_SUCCESS, LOGIN_ERROR, AUTH_ERROR, CLEAR_MSGS, LOGOUT, AUTH_SUCCESS } from '../actions/types';\nexport const AuthContext = createContext();\nexport const AuthActions = createContext();\nexport const AuthProvider = props => {\n  const init = {\n    loadingAuth: false,\n    user: \"\",\n    isAuthenticated: false,\n    authMsgs: \"\"\n  };\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(authReducer, init);\n\n  const checkAuth = async () => {\n    if (localState.token) {\n      authToken();\n    }\n\n    try {\n      const res = await axios.get(\"http://localhost:3000/api/admin/user\");\n      dispatch({\n        type: AUTH_SUCCESS,\n        payload: res.data\n      });\n    } catch (e) {\n      dispatch({\n        type: AUTH_ERROR,\n        payload: e.response.data\n      });\n    }\n\n    ;\n  };\n\n  const loginUser = async user => {\n    const config = {\n      header: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      const res = await axios.post(\"http://localhost:3000/api/admin/login\", user, config);\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: res.data\n      });\n    } catch (e) {\n      dispatch({\n        type: LOGIN_ERROR,\n        payload: e.response.data\n      });\n    }\n\n    ;\n  };\n\n  const logout = () => dispatch({\n    type: LOGOUT\n  });\n\n  const clearMsgs = () => dispatch({\n    type: CLEAR_MSGS\n  });\n\n  const actions = {\n    checkAuth,\n    loginUser,\n    logout,\n    clearMsgs\n  };\n  return __jsx(AuthContext.Provider, {\n    value: state\n  }, __jsx(AuthActions.Provider, {\n    value: actions\n  }, props.children));\n};","map":{"version":3,"sources":["C:/Users/domin/Documents/domcattell/site/context/contexts/auth.context.js"],"names":["React","createContext","useReducer","axios","authReducer","authToken","LOGIN_SUCCESS","LOGIN_ERROR","AUTH_ERROR","CLEAR_MSGS","LOGOUT","AUTH_SUCCESS","AuthContext","AuthActions","AuthProvider","props","init","loadingAuth","user","isAuthenticated","authMsgs","state","dispatch","checkAuth","localState","token","res","get","type","payload","data","e","response","loginUser","config","header","post","logout","clearMsgs","actions","children"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,UAA/B,QAAiD,OAAjD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,SACIC,aADJ,EAEIC,WAFJ,EAGIC,UAHJ,EAIIC,UAJJ,EAKIC,MALJ,EAMIC,YANJ,QAOO,kBAPP;AASA,OAAO,MAAMC,WAAW,GAAGX,aAAa,EAAjC;AACP,OAAO,MAAMY,WAAW,GAAGZ,aAAa,EAAjC;AAEP,OAAO,MAAMa,YAAY,GAAIC,KAAD,IAAW;AAEnC,QAAMC,IAAI,GAAG;AACTC,IAAAA,WAAW,EAAE,KADJ;AAETC,IAAAA,IAAI,EAAE,EAFG;AAGTC,IAAAA,eAAe,EAAE,KAHR;AAITC,IAAAA,QAAQ,EAAE;AAJD,GAAb;AAOA,QAAM;AAAA,OAACC,KAAD;AAAA,OAAQC;AAAR,MAAoBpB,UAAU,CAACE,WAAD,EAAcY,IAAd,CAApC;;AAEA,QAAMO,SAAS,GAAG,YAAY;AAC1B,QAAGC,UAAU,CAACC,KAAd,EAAqB;AACjBpB,MAAAA,SAAS;AACZ;;AACD,QAAI;AACA,YAAMqB,GAAG,GAAG,MAAMvB,KAAK,CAACwB,GAAN,CAAU,sCAAV,CAAlB;AACAL,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEjB,YADD;AAELkB,QAAAA,OAAO,EAAEH,GAAG,CAACI;AAFR,OAAD,CAAR;AAIH,KAND,CAME,OAAOC,CAAP,EAAU;AACRT,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEpB,UADD;AAELqB,QAAAA,OAAO,EAAEE,CAAC,CAACC,QAAF,CAAWF;AAFf,OAAD,CAAR;AAIH;;AAAA;AACJ,GAhBD;;AAkBA,QAAMG,SAAS,GAAG,MAAOf,IAAP,IAAgB;AAC9B,UAAMgB,MAAM,GAAG;AACXC,MAAAA,MAAM,EAAE;AACJ,wBAAgB;AADZ;AADG,KAAf;;AAMA,QAAI;AACA,YAAMT,GAAG,GAAG,MAAMvB,KAAK,CAACiC,IAAN,CAAW,uCAAX,EAAoDlB,IAApD,EAA0DgB,MAA1D,CAAlB;AACAZ,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEtB,aADD;AAELuB,QAAAA,OAAO,EAAEH,GAAG,CAACI;AAFR,OAAD,CAAR;AAIH,KAND,CAME,OAAOC,CAAP,EAAU;AACRT,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAErB,WADD;AAELsB,QAAAA,OAAO,EAAEE,CAAC,CAACC,QAAF,CAAWF;AAFf,OAAD,CAAR;AAIH;;AAAA;AACJ,GAnBD;;AAqBA,QAAMO,MAAM,GAAG,MAAMf,QAAQ,CAAC;AAACM,IAAAA,IAAI,EAAElB;AAAP,GAAD,CAA7B;;AACA,QAAM4B,SAAS,GAAG,MAAMhB,QAAQ,CAAC;AAACM,IAAAA,IAAI,EAAEnB;AAAP,GAAD,CAAhC;;AAEA,QAAM8B,OAAO,GAAG;AACZhB,IAAAA,SADY;AAEZU,IAAAA,SAFY;AAGZI,IAAAA,MAHY;AAIZC,IAAAA;AAJY,GAAhB;AAOA,SACI,MAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAEjB;AAA7B,KACI,MAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAEkB;AAA7B,KACKxB,KAAK,CAACyB,QADX,CADJ,CADJ;AAOH,CAnEM","sourcesContent":["import React, { createContext, useReducer } from 'react';\r\nimport axios from 'axios';\r\nimport authReducer from '../reducers/auth.reducer';\r\nimport authToken from '../../helpers/authToken';\r\nimport {\r\n    LOGIN_SUCCESS, \r\n    LOGIN_ERROR, \r\n    AUTH_ERROR, \r\n    CLEAR_MSGS, \r\n    LOGOUT,\r\n    AUTH_SUCCESS\r\n} from '../actions/types';\r\n\r\nexport const AuthContext = createContext();\r\nexport const AuthActions = createContext();\r\n\r\nexport const AuthProvider = (props) => {\r\n\r\n    const init = {\r\n        loadingAuth: false,\r\n        user: \"\",\r\n        isAuthenticated: false,\r\n        authMsgs: \"\"\r\n    };\r\n\r\n    const [state, dispatch] = useReducer(authReducer, init);\r\n\r\n    const checkAuth = async () => {\r\n        if(localState.token) {\r\n            authToken()\r\n        }\r\n        try {\r\n            const res = await axios.get(\"http://localhost:3000/api/admin/user\");\r\n            dispatch({\r\n                type: AUTH_SUCCESS,\r\n                payload: res.data\r\n            });\r\n        } catch (e) {\r\n            dispatch({\r\n                type: AUTH_ERROR,\r\n                payload: e.response.data\r\n            });\r\n        };\r\n    };\r\n\r\n    const loginUser = async (user) => {\r\n        const config = {\r\n            header: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        };\r\n\r\n        try {\r\n            const res = await axios.post(\"http://localhost:3000/api/admin/login\", user, config);\r\n            dispatch({\r\n                type: LOGIN_SUCCESS,\r\n                payload: res.data\r\n            });\r\n        } catch (e) {\r\n            dispatch({\r\n                type: LOGIN_ERROR,\r\n                payload: e.response.data\r\n            });\r\n        };\r\n    };\r\n\r\n    const logout = () => dispatch({type: LOGOUT});\r\n    const clearMsgs = () => dispatch({type: CLEAR_MSGS});\r\n\r\n    const actions = {\r\n        checkAuth,\r\n        loginUser,\r\n        logout,\r\n        clearMsgs\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={state}>\r\n            <AuthActions.Provider value={actions}>\r\n                {props.children}\r\n            </AuthActions.Provider>\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}